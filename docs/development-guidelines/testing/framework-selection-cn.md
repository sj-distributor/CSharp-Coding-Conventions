
# 测试框架选择
您可以在使用任何测试框架时应用本文档中的原则。
在其核心，.NET测试框架只是提供了一个运行器来查找和调用测试方法，将异常视为失败。
然而，当Headspring为一个项目选择一个.NET测试框架时，我们可以根据我们在[MSTest](https://docs.microsoft.com/en-us/dotnet/core/testing/unit-testing-with-mstest) 中的经验，指导客户做出最有效的选择，
[NUnit](https://nunit.org/) ，[xUnit](https://xunit.net/) ，和[Fixie](https://fixie.github.io/).


### **要** 偏爱 xUnit

xUnit基于NUnit中的许多设计选择。为每个测试用例构造一次测试类，从而更容易避免共享状态，并更容易通过普通的旧构造函数执行测试设置。由于模型更简单，在测试类中创建复杂继承的压力更小。
xUnit团队在解决.NETCore的复杂问题方面是迄今为止最积极的，因此它在所有版本的.NET和VisualStudio中都具有最佳的整体支持。因为ASP。NET和.NET核心团队已经接受了xUnit，它也是最有可能长期维护的。
选择xUnit时，请考虑以下缺点：

* 第一次设置xUnit时，我们建议禁用它的自动并行性，除非您有特殊需要利用它。很难避免并行测试以误导的方式相互干扰，特别是对于集成测试。
* 测试运行程序禁止常规控制台输出。您可能会发现自己无法控制台。问题测试中的WriteLine或Subject Under test（SUT）作为调试技术。

### **考虑** Fixie
[Fixie](https://fixie.github.io/) 基于xUnit中的许多设计选择，因此它最好与xUnit直接对比。使用Fixie：

* 装配加载模型要简单得多。您的测试项目只是从测试项目的“bin/…”文件夹运行的控制台应用程序。在撰写本文时，xUnit 3也计划进行类似的测试。
* 默认约定需要较少的样板代码。测试类只是一个简单的老式C#类，具有熟悉的语义。
* 测试执行自然是单线程的。
* 定制测试类生命周期要容易得多。
* 定制测试方法参数的含义要容易得多。

当然，我们的客户很少或根本没有接触到Fixie，因此我们更有可能将其用于主要由Headspring编写/维护的项目。

### **避免** NUnit

NUnit有一个复杂的测试类生命周期，这在实践中激发了一些测试设计气味：

* 由于一个测试类实例在其多个测试中被重用，因此无论是否有意，都会在测试中共享状态。
* 使用测试类级别设置和测试方法级别设置的混合来执行复杂的测试设置步骤。
* 很难跟踪继承以共享用于横切关注点的公共测试类级别和方法级别设置。

NUnit在适应.NETCore时代的工具方面也很慢，这意味着NUnit团队正面临并解决xUnit和Fixie多年前已经解决的复杂问题。我们应该避免为新项目选择NUnit。

### **避免** MSTest

MSTest与NUnit一样经历着复杂的测试类生命周期。近年来，它也很少受到微软的关注。甚至ASP.NET和.NET核心团队已经放弃使用它，转而使用xUnit。我们认为MSTest是一个遗留的工具，只有当客户的项目已经有了一个成熟的测试套件时，我们才会使用它。